---
phase: 10-navigation-ux
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/dashboard/rules/[id]/page.tsx
  - src/app/dashboard/rules/new/page.tsx
  - src/app/dashboard/accounts/[domain]/page.tsx
  - src/app/dashboard/emails/[id]/page.tsx
autonomous: true

must_haves:
  truths:
    - "Rule detail page shows breadcrumb: Rules > Rule Name"
    - "New Rule page shows breadcrumb: Rules > New Rule"
    - "Account detail page shows breadcrumb: Accounts > Company Name"
    - "Email detail page shows breadcrumb: Emails > Subject Preview"
  artifacts:
    - path: "src/app/dashboard/rules/[id]/page.tsx"
      provides: "Rule edit page with breadcrumbs"
      contains: "breadcrumbs"
    - path: "src/app/dashboard/accounts/[domain]/page.tsx"
      provides: "Account detail page with breadcrumbs"
      contains: "breadcrumbs"
  key_links:
    - from: "src/app/dashboard/rules/[id]/page.tsx"
      to: "src/components/layout/header.tsx"
      via: "breadcrumbs prop"
      pattern: "breadcrumbs=.*Rules"
---

<objective>
Add consistent breadcrumb navigation to all detail pages.

Purpose: Breadcrumbs provide clear context and one-click navigation back to parent sections. Currently Signal detail has breadcrumbs but Rules, Accounts, and Emails detail pages don't.

Output: All detail pages have consistent breadcrumb trail in Header component.
</objective>

<execution_context>
@/home/qualia/.claude/get-shit-done/workflows/execute-plan.md
@/home/qualia/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@src/components/layout/header.tsx
@src/app/dashboard/signals/[id]/page.tsx (reference for breadcrumb pattern)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add breadcrumbs to Rule detail and New Rule pages</name>
  <files>src/app/dashboard/rules/[id]/page.tsx, src/app/dashboard/rules/new/page.tsx</files>
  <action>
Add breadcrumbs prop to Header component in both rule pages.

For rules/[id]/page.tsx (Edit Rule):
1. Update Header to include breadcrumbs:
```tsx
<Header
  title="Edit Rule"
  subtitle={name || "Rule"}
  breadcrumbs={[
    { label: "Rules", href: "/dashboard/rules" },
    { label: name || "Edit Rule" },
  ]}
/>
```
2. Also update the loading state Header to show breadcrumbs

For rules/new/page.tsx (if exists, or create pattern):
1. Add similar breadcrumbs:
```tsx
<Header
  title="New Rule"
  breadcrumbs={[
    { label: "Rules", href: "/dashboard/rules" },
    { label: "New Rule" },
  ]}
/>
```

Note: The "Back to Rules" button can remain for mobile users, but breadcrumbs provide desktop navigation.
  </action>
  <verify>
1. Navigate to /dashboard/rules/[any-id]
2. Verify breadcrumb shows: Rules > [Rule Name]
3. Click "Rules" in breadcrumb - navigates to /dashboard/rules
4. Check loading state also shows breadcrumb structure
  </verify>
  <done>Rules detail pages show breadcrumb trail with clickable parent link</done>
</task>

<task type="auto">
  <name>Task 2: Add breadcrumbs to Account detail page</name>
  <files>src/app/dashboard/accounts/[domain]/page.tsx</files>
  <action>
Add breadcrumbs prop to Header component.

Update the Header in the success state:
```tsx
<Header
  title={account.company_name}
  subtitle={account.company_domain}
  breadcrumbs={[
    { label: "Accounts", href: "/dashboard/accounts" },
    { label: account.company_name },
  ]}
/>
```

Also update loading and error state Headers:
- Loading: `breadcrumbs={[{ label: "Accounts", href: "/dashboard/accounts" }, { label: "Loading..." }]}`
- Error: `breadcrumbs={[{ label: "Accounts", href: "/dashboard/accounts" }, { label: "Not Found" }]}`

The "Back to Accounts" button can remain as an additional navigation option.
  </action>
  <verify>
1. Navigate to /dashboard/accounts/[any-domain]
2. Verify breadcrumb shows: Accounts > Company Name
3. Click "Accounts" in breadcrumb - navigates to /dashboard/accounts
4. Check loading and error states show breadcrumbs
  </verify>
  <done>Account detail page shows breadcrumb trail</done>
</task>

<task type="auto">
  <name>Task 3: Add breadcrumbs to Email detail page</name>
  <files>src/app/dashboard/emails/[id]/page.tsx</files>
  <action>
Read the current email detail page and add breadcrumbs.

Add breadcrumbs prop to Header:
```tsx
<Header
  title={email.subject || "Email"}
  subtitle={email.company_name || "Generated Email"}
  breadcrumbs={[
    { label: "Emails", href: "/dashboard/emails" },
    { label: truncateText(email.subject, 40) || "Email" },
  ]}
/>
```

Create a truncateText helper inline if needed:
```tsx
const truncateText = (text: string, maxLength: number) =>
  text.length > maxLength ? text.slice(0, maxLength) + "..." : text;
```

Update loading/error states similarly.
  </action>
  <verify>
1. Navigate to /dashboard/emails/[any-id]
2. Verify breadcrumb shows: Emails > Subject Preview
3. Click "Emails" - navigates to /dashboard/emails
4. Long subjects are truncated in breadcrumb
  </verify>
  <done>Email detail page shows breadcrumb trail with truncated subject</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes
2. Rules/[id] page: breadcrumb visible (Rules > Rule Name)
3. Rules/new page: breadcrumb visible (Rules > New Rule)
4. Accounts/[domain] page: breadcrumb visible (Accounts > Company)
5. Emails/[id] page: breadcrumb visible (Emails > Subject)
6. All breadcrumb parent links navigate correctly
7. Signals/[id] page still has breadcrumbs (regression check)
</verification>

<success_criteria>
- All four detail pages (Rules, Rules/new, Accounts, Emails) have breadcrumbs
- Breadcrumb parent link navigates to list page
- Current page shown without link (final breadcrumb item)
- Loading/error states also show breadcrumbs
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/10-navigation-ux/10-02-SUMMARY.md`
</output>
