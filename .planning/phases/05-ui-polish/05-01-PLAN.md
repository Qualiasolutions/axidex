---
phase: 05-ui-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/dashboard/signals/page.tsx
autonomous: true

must_haves:
  truths:
    - "Pagination controls appear when more than 20 signals exist"
    - "User can navigate between pages of signals"
    - "Current page number and total count are visible"
    - "Pagination state persists in URL for sharing"
  artifacts:
    - path: "src/app/dashboard/signals/page.tsx"
      provides: "Pagination controls integrated into signals list"
      contains: "offset"
  key_links:
    - from: "src/app/dashboard/signals/page.tsx"
      to: "/api/signals"
      via: "fetch with limit and offset params"
      pattern: "limit.*offset"
---

<objective>
Add pagination controls to the signals list page.

Purpose: When users have many signals (20+), they need pagination to browse efficiently without loading hundreds of items at once.
Output: Signals page with Previous/Next buttons and page indicator, using existing API limit/offset support.
</objective>

<execution_context>
@/home/qualia/.claude/get-shit-done/workflows/execute-plan.md
@/home/qualia/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md

# The API already supports pagination - we just need UI
@src/lib/queries/signals.ts
@src/app/api/signals/route.ts
@src/app/dashboard/signals/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add pagination state and controls to signals page</name>
  <files>src/app/dashboard/signals/page.tsx</files>
  <action>
Update the signals page to add pagination:

1. Add pagination URL state:
   - Read `page` param from searchParams (default 1)
   - Calculate offset as `(page - 1) * ITEMS_PER_PAGE` where ITEMS_PER_PAGE = 20

2. Update fetch to include pagination params:
   - Pass `limit=20` and calculated `offset` to API
   - Use the existing `totalCount` state (already returned from API as `count`)

3. Calculate pagination metadata:
   - `totalPages = Math.ceil(totalCount / ITEMS_PER_PAGE)`
   - `hasNextPage = currentPage < totalPages`
   - `hasPrevPage = currentPage > 1`

4. Add pagination controls below the signals list (after the signals map, before empty state):
   ```tsx
   {/* Pagination - only show if more than one page */}
   {!loading && !error && totalPages > 1 && (
     <motion.div
       initial={{ opacity: 0, y: 12 }}
       animate={{ opacity: 1, y: 0 }}
       transition={{ duration: 0.3, delay: 0.1 }}
       className="flex items-center justify-between pt-4 border-t border-[var(--border-subtle)]"
     >
       <span className="text-sm text-[var(--text-tertiary)]">
         Page {currentPage} of {totalPages}
       </span>
       <div className="flex items-center gap-2">
         <Button
           variant="secondary"
           size="sm"
           onClick={() => goToPage(currentPage - 1)}
           disabled={!hasPrevPage}
         >
           Previous
         </Button>
         <Button
           variant="secondary"
           size="sm"
           onClick={() => goToPage(currentPage + 1)}
           disabled={!hasNextPage}
         >
           Next
         </Button>
       </div>
     </motion.div>
   )}
   ```

5. Create goToPage function that updates URL:
   ```tsx
   const goToPage = (page: number) => {
     const params = new URLSearchParams(searchParams.toString());
     if (page > 1) {
       params.set("page", page.toString());
     } else {
       params.delete("page");
     }
     router.push(`/dashboard/signals?${params.toString()}`);
   };
   ```

6. Reset to page 1 when any filter changes:
   - In toggleTypeFilter, setDatePreset, etc. - delete "page" param when changing filters
   - This ensures user sees first page of new filter results

Style notes:
- Use existing design tokens (var(--text-tertiary), var(--border-subtle))
- Match existing motion patterns (initial/animate/transition)
- Keep controls subtle - text-sm, secondary variant buttons
  </action>
  <verify>
Run `npm run build` to verify no TypeScript errors.
Visit http://localhost:3000/dashboard/signals with more than 20 signals - pagination controls should appear.
  </verify>
  <done>
- Pagination controls visible when totalCount > 20
- Previous/Next buttons navigate pages
- Page state persists in URL (?page=2)
- Changing filters resets to page 1
  </done>
</task>

<task type="auto">
  <name>Task 2: Update stats bar to show total vs current page</name>
  <files>src/app/dashboard/signals/page.tsx</files>
  <action>
Update the stats bar to show pagination context:

1. Change "Showing X signals" to "Showing X of Y signals" when paginated:
   ```tsx
   <Badge variant="default">
     {totalCount > ITEMS_PER_PAGE
       ? `${signals.length} of ${totalCount} signals`
       : `${signals.length} signals`}
   </Badge>
   ```

2. Ensure totalCount is used (not signals.length) for the total:
   - The API already returns `count` (total matching filters)
   - `signals.length` is just the current page

This gives users context that they're viewing a subset of results.
  </action>
  <verify>
With 50 signals and on page 1, stats bar should show "20 of 50 signals".
With 15 signals total, stats bar should show "15 signals".
  </verify>
  <done>
Stats bar accurately reflects current page vs total count.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` - no TypeScript errors
2. With >20 signals: pagination controls appear, Previous/Next work
3. With <=20 signals: no pagination controls shown
4. URL shows `?page=2` on page 2, no `?page=` on page 1
5. Changing filters (type, date) resets to page 1
6. Stats bar shows "X of Y signals" when paginated
</verification>

<success_criteria>
- Pagination controls render when totalCount exceeds 20
- Previous/Next navigation works correctly
- Page number persists in URL
- Filter changes reset pagination
- Stats bar reflects page context
</success_criteria>

<output>
After completion, create `.planning/phases/05-ui-polish/05-01-SUMMARY.md`
</output>
