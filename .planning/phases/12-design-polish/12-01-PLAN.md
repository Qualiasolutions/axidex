---
phase: 12-design-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/app/layout.tsx
  - src/components/ui/toaster.tsx
  - src/components/ui/empty-state.tsx
  - src/app/dashboard/rules/page.tsx
autonomous: true

must_haves:
  truths:
    - "Toast notifications appear when rules are toggled, deleted, or duplicated"
    - "EmptyState component renders with icon, title, description, and actions"
    - "Sonner toaster is mounted in root layout"
  artifacts:
    - path: "src/components/ui/toaster.tsx"
      provides: "Toaster wrapper component"
      exports: ["Toaster"]
    - path: "src/components/ui/empty-state.tsx"
      provides: "Reusable empty state component"
      exports: ["EmptyState"]
  key_links:
    - from: "src/app/layout.tsx"
      to: "src/components/ui/toaster.tsx"
      via: "component import and render"
      pattern: "<Toaster"
    - from: "src/app/dashboard/rules/page.tsx"
      to: "sonner"
      via: "toast function calls"
      pattern: "toast\\.(success|error)"
---

<objective>
Set up toast notification system and create reusable EmptyState component

Purpose: Foundation for user feedback and consistent empty states across the app
Output: Sonner toasts working, EmptyState component ready for use
</objective>

<execution_context>
@/home/qualia/.claude/get-shit-done/workflows/execute-plan.md
@/home/qualia/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Source files to read
@src/app/layout.tsx
@src/app/dashboard/rules/page.tsx
@src/app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install sonner and create Toaster component</name>
  <files>package.json, src/components/ui/toaster.tsx, src/app/layout.tsx</files>
  <action>
    1. Install sonner: `npm install sonner`

    2. Create `src/components/ui/toaster.tsx`:
    ```tsx
    "use client";

    import { Toaster as SonnerToaster } from "sonner";

    export function Toaster() {
      return (
        <SonnerToaster
          position="bottom-right"
          toastOptions={{
            style: {
              background: "var(--background)",
              color: "var(--foreground)",
              border: "1px solid var(--border)",
            },
            classNames: {
              success: "!bg-emerald-50 !border-emerald-200 !text-emerald-800",
              error: "!bg-red-50 !border-red-200 !text-red-800",
            },
          }}
        />
      );
    }
    ```

    3. Add Toaster to `src/app/layout.tsx`:
    - Import: `import { Toaster } from "@/components/ui/toaster";`
    - Add `<Toaster />` inside body, after children
  </action>
  <verify>
    - `npm run build` passes
    - Toaster component exists and exports correctly
    - Layout includes Toaster
  </verify>
  <done>Sonner installed, Toaster mounted in root layout</done>
</task>

<task type="auto">
  <name>Task 2: Create reusable EmptyState component</name>
  <files>src/components/ui/empty-state.tsx</files>
  <action>
    Create `src/components/ui/empty-state.tsx`:

    ```tsx
    "use client";

    import { motion } from "motion/react";
    import type { LucideIcon } from "lucide-react";
    import { cn } from "@/lib/utils";

    interface EmptyStateProps {
      icon: LucideIcon;
      title: string;
      description: string;
      children?: React.ReactNode; // Action buttons
      className?: string;
    }

    export function EmptyState({
      icon: Icon,
      title,
      description,
      children,
      className,
    }: EmptyStateProps) {
      return (
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.4, ease: [0.16, 1, 0.3, 1] }}
          className={cn(
            "flex flex-col items-center justify-center py-20 px-6 text-center",
            "bg-background rounded-2xl border border-border/50",
            className
          )}
        >
          <div className="size-16 rounded-2xl bg-gradient-to-br from-accent/20 to-orange-500/20 flex items-center justify-center mb-6">
            <Icon className="size-7 text-accent" />
          </div>
          <h3 className="text-lg font-bold text-foreground mb-2">{title}</h3>
          <p className="text-sm text-muted-foreground max-w-md mb-8 leading-relaxed">
            {description}
          </p>
          {children && (
            <div className="flex items-center gap-3 flex-wrap justify-center">
              {children}
            </div>
          )}
        </motion.div>
      );
    }
    ```

    Design notes:
    - Uses motion for entrance animation (consistent with app patterns)
    - Gradient icon background matches existing empty states in signals page
    - Accepts children for action buttons (flexible composition)
    - Typography follows existing patterns: font-bold title, muted-foreground description
    - Uses design system variables (bg-background, border-border, text-foreground)
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - Component exports correctly
  </verify>
  <done>EmptyState component created with consistent styling</done>
</task>

<task type="auto">
  <name>Task 3: Add toast notifications to Rules page</name>
  <files>src/app/dashboard/rules/page.tsx</files>
  <action>
    1. Add import at top: `import { toast } from "sonner";`

    2. Update `handleToggleRule`:
    - On success: `toast.success(isActive ? "Rule activated" : "Rule paused");`
    - On error: `toast.error("Failed to update rule");`

    3. Update `handleDeleteRule`:
    - On success: `toast.success("Rule deleted");`
    - On error: `toast.error("Failed to delete rule");`

    4. Update `handleDuplicateRule`:
    - On success: `toast.success("Rule duplicated");`
    - On error: `toast.error("Failed to duplicate rule");`

    5. Update `handleCreateFromTemplate`:
    - On success: `toast.success(\`Created "${template.name}" rule\`);`
    - On error: `toast.error("Failed to create rule");`

    Place success toasts AFTER `mutate()` call.
    Place error toasts in catch blocks BEFORE rollback.
  </action>
  <verify>
    - `npm run build` passes
    - Toggle a rule in browser: toast appears
    - Delete a rule: toast appears
    - Duplicate a rule: toast appears
  </verify>
  <done>Rules page shows toast feedback for all user actions</done>
</task>

</tasks>

<verification>
1. Run `npm run build` - should pass
2. Run `npx tsc --noEmit` - no type errors
3. Start dev server, visit /dashboard/rules
4. Create rule from template - toast appears
5. Toggle rule active/inactive - toast appears
6. Delete a rule - toast appears
7. Duplicate a rule - toast appears
</verification>

<success_criteria>
- Sonner installed and Toaster mounted
- EmptyState component exists with icon, title, description, children props
- Rules page shows toast notifications for toggle, delete, duplicate, create
- All toasts use consistent styling (success green, error red)
- Build passes with no type errors
</success_criteria>

<output>
After completion, create `.planning/phases/12-design-polish/12-01-SUMMARY.md`
</output>
